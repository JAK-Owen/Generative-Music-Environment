<!DOCTYPE html>
<html>
<body>

<button> START </button>
<script src='https://cdnjs.cloudflare.com/ajax/libs/tone/14.7.6/Tone.js'></script>

<script>


////////////////////////////////////////////////////////////////////////
// KEY SELECTOR
////////////////////////////////////////////////////////////////////////

const key = {
  cMinor:      ["c2", "d2", "d#2", "f2", "g2", "g#2","a#2","c3", "d3", "d#3", "f3", "g3", "g#3","a#3"],
  cSharpMinor: ["c#2", "d#2", "e2", "f#2", "g#2", "a2", "b2","c#3", "d#3", "e3", "f#3", "g#3", "a3", "b3"],
  dMinor:      ["d2", "e2", "f2", "g2", "a2", "a#2", "c2","d3", "e3", "f3", "g3", "a3", "a#3", "c3"],
  dSharpMinor: ["d#2", "e#2", "f#2", "g#2", "a#2", "b2", "c#2","d#3", "e#3", "f#3", "g#3", "a#3", "b3", "c#3"],
  eMinor:      ["e2", "f#2", "g2", "a2", "b2", "c2", "d2","e3", "f#3", "g3", "a3", "b3", "c3", "d3"],
  fMinor:      ["f2", "g2", "g#2", "a#2", "c2", "c#2", "d#2","f3", "g3", "g#3", "a#3", "c3", "c#3", "d#3"],
  fSharpMinor: ["f#2", "g#2", "a2", "b2", "c#2", "d2", "e2","f#3", "g#3", "a3", "b3", "c#3", "d3", "e3"],
  gMinor:      ["g2", "a2", "a#2", "c2", "d2", "d#2", "f2","g3", "a3", "a#3", "c3", "d3", "d#3", "f3"],
  gSharpMinor: ["g#2", "a#2", "b2", "c#2", "d#2", "e2", "f#2","g#3", "a#3", "b3", "c#3", "d#3", "e3", "f#3"],
  aMinor:      ["a2", "b2", "c2", "d2", "e2", "f2", "g2","a3", "b3", "c3", "d3", "e3", "f3", "g3"],
  aSharpMinor: ["a#2", "b#2", "c#2", "d#2", "e#2", "f#2", "g#2","a#3", "b#3", "c#3", "d#3", "e#3", "f#3", "g#3"],
  bMinor:      ["b2", "c#2", "d2", "e2", "f#2", "g2", "a2","b3", "c#3", "d3", "e3", "f#3", "g3", "a3"],

};




const { cMinor } = key;




//////////////////////////////////////////////////////
// GLOBAL TRANSPORT AND EFFECTS
//////////////////////////////////////////////////////

Tone.Transport.bpm.value = 16.25;

const reverb = new Tone.Reverb(10).toDestination();

const delay = new Tone.FeedbackDelay("16n.", 0.9).connect(reverb);

const shortReverb = new Tone.Reverb(7).toDestination();

const shortDelay = new Tone.FeedbackDelay("8n.", 0.4).connect(shortReverb);

//////////////////////////////////////////////////////
// SYNTH INST 1
//////////////////////////////////////////////////////

  const synth1 = new Tone.Synth({

    "volume": -8,
  "oscillator": {
    "type": "triangle"
  },
  "envelope": {
    "attack": 0.8,
    "decay": 20.0,
    "sustain": 0.0,
    "release": 20.0,
  },
  "filterEnvelope": {
    "attack": 0.8,
    "decay": 20.0,
    "sustain": 0.0,
    "release": 20.0,
    "baseFrequency": 300,
    "octaves": 4
  }});

  synth1.connect(delay);

  const pattern1 = key.dMinor;

  console.log(key);


var index = 0;

Tone.Transport.scheduleRepeat(time => {
  repeat(time);
}, '1n');

function repeat(time) {
  let note = pattern1[Math.floor(Math.random() * pattern1.length)];
  synth1.triggerAttackRelease(note, '1n', time);
  synth1.envelope.triggerAttackRelease("1n");
  index++;
}
Tone.Transport.start();


///////////////////////////////////////////////

// const synth2 = new Tone.Synth({
//
//   "volume": -10,
// "oscillator": {
//   "type": "triangle"
// },
// "envelope": {
//   "attack": 0.8,
//   "decay": 20.0,
//   "sustain": 0.0,
//   "release": 20.0,
// },
// "filterEnvelope": {
//   "attack": 0.8,
//   "decay": 20.0,
//   "sustain": 0.0,
//   "release": 20.0,
//   "baseFrequency": 300,
//   "octaves": 4
// }});
//
// synth2.connect(delay);
//
// const pattern2 = key;
//
//
// var index = 0;
//
// Tone.Transport.scheduleRepeat(time => {
// repeat2(time);
// }, '1n');
//
// function repeat2(time) {
// let note = pattern2[Math.floor(Math.random() * pattern2.length)];
// synth2.triggerAttackRelease(note, '1n', time);
// synth2.envelope.triggerAttackRelease("1n");
// index++;
// }
//
// ///////////////////////////////////////////////
//
// const synth3 = new Tone.Synth({
//
//   "volume": -9,
// "oscillator": {
//   "type": "triangle"
// },
// "envelope": {
//   "attack": 0.8,
//   "decay": 20.0,
//   "sustain": 0.0,
//   "release": 20.0,
// },
// "filterEnvelope": {
//   "attack": 0.8,
//   "decay": 20.0,
//   "sustain": 0.0,
//   "release": 20.0,
//   "baseFrequency": 300,
//   "octaves": 4
// }});
//
// synth3.connect(delay);
//
// const pattern3 = key;
//
//
// var index = 0;
//
// Tone.Transport.scheduleRepeat(time => {
// repeat3(time);
// }, '1n');
//
// function repeat3(time) {
// let note = pattern3[Math.floor(Math.random() * pattern3.length)];
// synth3.triggerAttackRelease(note, '1n', time);
// synth3.envelope.triggerAttackRelease("1n");
// index++;
// }
//
// ///////////////////////////////////////////////
//
// const synth4 = new Tone.Synth({
//
//   "volume": -10,
// "oscillator": {
//   "type": "triangle"
// },
// "envelope": {
//   "attack": 0.8,
//   "decay": 20.0,
//   "sustain": 0.0,
//   "release": 20.0,
// },
// "filterEnvelope": {
//   "attack": 0.8,
//   "decay": 20.0,
//   "sustain": 0.0,
//   "release": 20.0,
//   "baseFrequency": 300,
//   "octaves": 4
// }});
//
// const panner4 = new Tone.Panner(-1).connect(delay);
//
// synth4.connect(panner4);
//
// const pattern4 = key;
//
//
// var index = 0;
//
// Tone.Transport.scheduleRepeat(time => {
// repeat4(time);
// }, '1n');
//
// function repeat4(time) {
// let note = pattern4[Math.floor(Math.random() * pattern4.length)];
// synth4.triggerAttackRelease(note, '1n', time);
// synth4.envelope.triggerAttackRelease("1n");
// index++;
// }
//
// ///////////////////////////////////////////////
//
// const synth5 = new Tone.Synth({
//
//   "volume": -10,
// "oscillator": {
//   "type": "triangle"
// },
// "envelope": {
//   "attack": 0.8,
//   "decay": 20.0,
//   "sustain": 0.0,
//   "release": 20.0,
// },
// "filterEnvelope": {
//   "attack": 0.8,
//   "decay": 20.0,
//   "sustain": 0.0,
//   "release": 20.0,
//   "baseFrequency": 300,
//   "octaves": 4
// }});
//
// const panner5 = new Tone.Panner(1).connect(delay);
//
// synth5.connect(panner5);
//
// const pattern5 = key;
//
//
// var index = 0;
//
// Tone.Transport.scheduleRepeat(time => {
// repeat5(time);
// }, '1n');
//
// function repeat5(time) {
// let note = pattern5[Math.floor(Math.random() * pattern5.length)];
// synth5.triggerAttackRelease(note, '1n', time);
// synth5.envelope.triggerAttackRelease("1n");
// index++;
// }
//
// //////////////////////////////////////////////////////////////////////
// //ARP INST1
// //////////////////////////////////////////////////////////////////////
//
// const arp = new Tone.Synth({
//
//   "volume": 2,
// "oscillator": {
//   "type": "triangle"
// },
// "envelope": {
//   "attack": 0.0,
//   "decay": 0.3,
//   "sustain": 0.0,
//   "release": 0.5,
// },
// "filterEnvelope": {
//   "attack": 0.0,
//   "decay": 0.3,
//   "sustain": 0.0,
//   "release": 0.5,
//   "baseFrequency": 300,
//   "octaves": 4
// }});
//
// const pannerA1 = new Tone.Panner(0.5).connect(shortDelay);
//
// arp.connect(pannerA1);
//
// const arpPattern = key;
//
//
// var index = 0;
//
// Tone.Transport.scheduleRepeat(time => {
// repeatArp(time);
// }, '4n');
//
// function repeatArp(time) {
// let note = arpPattern[Math.floor(Math.random() * arpPattern.length)];
// arp.triggerAttackRelease(note, '4n', time);
// arp.envelope.triggerAttackRelease("4n");
// index++;
// }
//
// //////////////////////////////////////////////////////////////////////
//
// const arp2 = new Tone.Synth({
//
//   "volume": 2,
// "oscillator": {
//   "type": "triangle"
// },
// "envelope": {
//   "attack": 0.0,
//   "decay": 0.3,
//   "sustain": 0.0,
//   "release": 0.5,
// },
// "filterEnvelope": {
//   "attack": 0.0,
//   "decay": 0.3,
//   "sustain": 0.0,
//   "release": 0.5,
//   "baseFrequency": 300,
//   "octaves": 4
// }});
//
// const pannerA2 = new Tone.Panner(-0.5).connect(shortDelay);
//
// arp2.connect(pannerA2);
//
// const arp2Pattern = key;
//
//
// var index = 0;
//
// Tone.Transport.scheduleRepeat(time => {
// repeatArp2(time);
// }, '8n.');
//
// function repeatArp2(time) {
// let note = arp2Pattern[Math.floor(Math.random() * arp2Pattern.length)];
// arp2.triggerAttackRelease(note, '8n.', time);
// arp2.envelope.triggerAttackRelease("8n.");
// index++;
// }

//////////////////////////////////////////////////////////////////////

  document.querySelector('button')?.addEventListener('click', async () => {
      await Tone.start()
  })



</script>

</body>
</html>
